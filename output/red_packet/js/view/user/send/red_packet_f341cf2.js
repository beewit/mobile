var wecatInit=!1;new Vue({el:"#app",data:{on:"index",nav:{back:"false",title:"发红包",rtext:""},index:0,isLoginAccount:!0,model:{sendName:"张三",sendPhoto:config.defaultPhoto,randomMoney:1},sendPhotoImage:config.defaultPhoto,joinCouponIds:null,blessings:null,remarks:null,money:1,redPacketCardId:null,redPacketCardName:null,feeMoney:0,couponList:{PageIndex:0,Data:null},selectCouponList:null,expireComponyFunc:!0,Loading:!1,arrayRandomMoney:[{id:1,name:"1元"},{id:3,name:"1~3元"},{id:5,name:"1~5元"},{id:10,name:"1~10元"},{id:20,name:"1~20元"},{id:30,name:"1~30元"},{id:50,name:"1~50元"},{id:100,name:"1~100元"},{id:200,name:"1~200元"}]},mounted:function(){var n=this;wechatSDK.initConfig(["chooseImage","uploadImage","previewImage","chooseWXPay"],function(){wecatInit=!0}),setTimeout(function(){common.getEffectiveFuncById(common.redPacketFuncId,function(){n.expireComponyFunc=common.getRedPacketFuncExpireTime()})},100)},methods:{backClick:function(){this.on="index",this.nav.back="false",this.nav.title="发红包"},chooseImage:function(){var n=this;return wecatInit?void wechatSDK.chooseImage(1,function(t){alert(JSON.stringify(t)),n.model.sendPhoto=t.data.path,n.sendPhotoImage=t.data.url},function(){layer.msg("上传失败",{icon:0})}):void layer.msg("刷新页面重试")},changeRandomMoney:function(n){this.model.randomMoney=n,console.log(event)},tapSelectCoupon:function(n){this.couponList.Data[n].cls?Vue.set(this.couponList.Data[n],"cls",null):Vue.set(this.couponList.Data[n],"cls","active");var t=new Array;for(var n in this.couponList.Data)this.couponList.Data[n].cls&&t.push(this.couponList.Data[n].id);this.joinCouponIds=t.join(",")},submit:function(){return void wechatSDK.paymentRedPacket(6546171523515392,function(n){n&&(layer.msg("支付成功"),location.href="/red_packet/pages/receive/red_packet.html?id=6546171523515392")})},bindSelectCoupon:function(){this.on="coupon",this.nav.back=!0,this.nav.title="选择展示代金券",0==this.couponList.PageIndex&&this.getCouponList(1)},bindSelectRedPacketCard:function(){this.on="redpacket",this.nav.back=!0,this.nav.title="选择红包名片"},getCouponList:function(n){var t=this;common.ajax({url:config.getCouponListUrl,data:{pageIndex:n},success:function(e){if(1==n)t.couponList=e.data;else{t.couponList.Data.reverse();for(var o in t.couponList.Data)e.data.Data.push(this.couponList.Data[o]);t.couponList.Data.reverse(),e.data.isLoadData=!0,t.couponList=e.data}Vue.set(t,"couponList",t.couponList)}})}}});